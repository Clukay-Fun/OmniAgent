# Tools (外部工具箱与开发辅助集群)

`tools/` 目录存放的并不是 Agent 在线上运行时直接调用的主业务代码。它是游离于核心服务之外的**“军火库”与“安全哨兵”**，主要服务于开发者本地排错、自动化 CI/CD 质检与全剧本的安全门面保护。

遵循 `nanoclaw` 的外壳剥离哲学，所有可能污染主体运行环境或者是极为小众的测试能力，都会被剥离、下放到这里作为独立执行体（Stand-alone Scripts）存在。

## 目录模块解析

### 1. `dev/` (开发者瑞士军刀)
包含你在调试飞书卡片、模拟网络穿透或者离线试调时的外挂脚本套件。
- **`ngrok_mux.py`**: 典型的本地开发内网穿透复用器。当你不想每次联调时都更改飞书开发者后台 Webhook 地址，可以用它让飞书回调稳定打入本地被调试的 `main.py` 端口（8080）。
- **`preview_card_payload.py`**: **飞书交互式卡片渲染器**。用来脱机写界面卡片，随时查看这串庞大的 JSON payload 会在飞书富文本界面呈现成怎么样的样式。
- **`run_scenario_dialogue_tests.py` & `validate_scenarios.py`**: 提供离线模式下的系统拟真剧本对抗能力，验证大模型的表现度或意图解析器的韧性。

*(附注：原本此目录下包含用于 PostgreSQL 的 `init_db.sql` 脚手架，在项目完成向全飞书自动化的无状态架构 [Stateless Migration] 迁移后，历史包袱已被斩断拔除。)*

### 2. `ci/` (持续集成断头台)
当代码即将提交到 Github 并合入主线前，这些脚本将被自动化管线 (`Github Actions` 或 Git Hooks) 触发，扮演冷血的质检官。
- **`check_core_boundary.py`**: **架构防腐门神**。它通过重型 AST (抽象语法树) 解析机制，严查任何人是否试图越权：例如强制禁止 `src/core` 中的“大脑”主动向外去调用 `src/adapters` 中杂而不纯的具体通信协议格式。
- **`check_mcp_config_consistency.py`**: 保障外部大库 (MCP Server) 与本项目字典的一致性，防止字段空降导致线上雪崩。
- **覆盖率相关 (`run_coverage.*`)**: 检测单元测试网是否破损的外挂测高仪。

### 3. `usage_report.py` (用量账单审计)
- **核心职能**：它会跑盘吃下 `src/utils/metrics.py` 落下的结构化使用记录（Log），将枯燥的 Token 使用行聚合为一个赏心悦目的项目成本损耗表并推演花费价格。这相当于在没有任何 APM (如 Datadog) 环境下的极简平替。

---

## 运维建议
在这个文件夹下工作，你能体会到最为现代化的企业级工程素养。无论你是希望验证一条冷门的 Prompt，还是试图在本地发一条高难度卡片测试，都请不要修改 `src/main.py` 里面的主线逻辑。**新开一个脚本，丢在这里单独执行它，这才是成熟开发者的行为准则。**
