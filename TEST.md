测试用例
测试 1：基础查询功能
目的：验证查询技能和状态提示

操作：

在飞书中发送消息："查询今天的案件"
观察是否先显示 "💭 正在思考..."
观察消息是否更新为查询结果
预期结果：

✅ 显示状态提示
✅ 消息更新为查询结果
✅ 结果格式符合 SOUL.md 规范
测试 2：用户身份绑定
目的：验证用户身份管理

操作：

首次发送消息（如果之前没绑定）
观察是否提示绑定
发送："绑定 张三"（替换为实际律师姓名）
观察绑定结果
预期结果：

✅ 自动尝试匹配"主办律师"字段
✅ 匹配成功显示成功消息
✅ 或提示手动绑定
测试 3："我的案件"查询
目的：验证用户身份过滤

前提：已绑定律师身份

操作：

发送："我的案件"
观察结果是否只显示该律师负责的案件
预期结果：

✅ 只显示绑定律师的案件
✅ 如果未绑定，提示先绑定
测试 4：创建案件
目的：验证 CreateSkill

操作：

发送："新建案件"
按提示输入案件信息
预期结果：

✅ 引导式创建流程
✅ 创建成功后返回案件链接
✅ 格式符合 SOUL.md
测试 5：更新案件
目的：验证 UpdateSkill

操作：

先查询一个案件："查询案号XXX"
发送："把开庭日改成2024-12-15"
预期结果：

✅ 识别更新意图
✅ 更新成功
✅ 显示更新后的字段
测试 6：删除案件（二次确认）
目的：验证 DeleteSkill 和二次确认

操作：

先查询一个案件："查询案号XXX"
发送："删除这个案件"
观察确认提示
发送："确认删除"
预期结果：

✅ 显示确认提示（包含案号）
✅ 提示"此操作不可撤销"
✅ 确认后删除成功
测试 7：开庭日提醒（需等待）
目的：验证 HearingReminderScheduler

前提：

配置了 HEARING_REMINDER_ENABLED=true
配置了 HEARING_REMINDER_CHAT_ID
数据库中有未来几天的开庭案件
操作：

等待每日扫描时间（默认 8:00）
或手动触发（修改扫描时间为当前时间）
预期结果：

✅ 在指定 chat_id 收到提醒
✅ 提醒包含案号、开庭日期、紧急程度
✅ 不重复发送
测试 8：错误处理
目的：验证友好的错误提示

操作：

查询不存在的案件："查询案号不存在的XXX"
尝试删除但不确认（发送其他内容）
预期结果：

✅ 显示友好的错误消息
✅ 提供建议（如"检查案号是否正确"）
✅ 符合 SOUL.md 的错误处理模板
测试 9：闲聊和边界
目的：验证 ChitchatSkill 和专业边界

操作：

发送："你好"
发送："这个案子能赢吗？"
预期结果：

✅ 友好回应问候
✅ 拒绝预测案件结果
✅ 引导用户咨询专业律师
检查点
启动服务后，检查以下内容：

1. 日志检查

bash
# 查看是否有错误
grep -i error logs/feishu-agent.log
# 查看技能注册
grep "Registered skills" logs/feishu-agent.log
2. 配置检查

bash
# 确认环境变量已加载
# 检查 .env 文件是否包含所有必要配置
3. 数据库检查（如果使用 PostgreSQL）

sql
-- 检查提醒表
SELECT * FROM reminders WHERE status = 'pending';
-- 检查是否有开庭案件数据
-- （通过 MCP 查询）
常见问题排查
问题 1：服务启动失败

检查 Python 版本（需要 3.10+）
检查依赖是否安装：pip install -r requirements.txt
检查 
.env
 文件是否存在
问题 2：状态提示不显示

检查飞书 API 权限
检查消息更新 API 是否可用
查看日志中的错误信息
问题 3：用户身份绑定失败

检查 MCP Server 是否运行
检查"主办律师"字段是否存在
检查姓名是否完全匹配
问题 4：开庭日提醒未发送

检查 HEARING_REMINDER_ENABLED=true
检查 HEARING_REMINDER_CHAT_ID 是否正确
检查扫描时间配置
查看调度器日志
📋 测试检查清单
□ 服务成功启动
□ 所有技能已注册
□ 状态提示正常显示
□ 消息更新正常工作
□ 用户身份绑定成功
□ "我的案件"过滤正确
□ 创建案件成功
□ 更新案件成功
□ 删除案件二次确认正常
□ 开庭日提醒发送成功
□ 错误提示友好清晰
□ 闲聊和边界处理正确
□ SOUL.md 人格体现明显
你现在可以按照这个测试计划进行测试。如果遇到任何问题或错误，请把错误日志发给我，我会帮你解决！

需要我帮你检查配置文件或查看特定的代码吗？