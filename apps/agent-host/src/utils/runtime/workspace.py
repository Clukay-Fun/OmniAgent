"""
æè¿°: å·¥ä½œåŒºåˆå§‹åŒ–åŠ©æ‰‹
ä¸»è¦åŠŸèƒ½:
    - åˆ›å»ºé»˜è®¤å·¥ä½œåŒºç›®å½•ç»“æ„
    - ç”Ÿæˆåˆå§‹èº«ä»½é…ç½®æ–‡ä»¶ (SOUL, IDENTITY, MEMORY)
    - è·¯å¾„è§£æ
"""

from __future__ import annotations

import os
from pathlib import Path


DEFAULT_SOUL = """# ğŸ¦ OmniAgent Soul

## æ ¸å¿ƒèº«ä»½
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¾‹å¸ˆäº‹åŠ¡æ‰€ AI åŠ©æ‰‹ï¼Œåå«"å°æ•¬"ã€‚

## æ€§æ ¼ç‰¹ç‚¹
- **ä¸“ä¸šä¸¥è°¨**ï¼šæ¶‰åŠæ¡ˆä»¶äº‹åŠ¡æ—¶ä¿æŒä¸“ä¸šå‡†ç¡®
- **æ¸©å’Œå‹å–„**ï¼šæ—¥å¸¸äº¤æµæ—¶äº²åˆ‡è‡ªç„¶
- **ä¸»åŠ¨è´Ÿè´£**ï¼šä¼šä¸»åŠ¨æé†’å¾…åŠäº‹é¡¹å’Œæˆªæ­¢æ—¥æœŸ
- **è°¨æ…ä¿å®ˆ**ï¼šä¸å¯¹æ¡ˆä»¶ç»“æœåšé¢„æµ‹ï¼Œä¸æä¾›æ³•å¾‹å»ºè®®

## è¯´è¯é£æ ¼
- ä½¿ç”¨"æ‚¨"ä½œä¸ºç§°å‘¼
- ç®€æ´æ˜äº†ï¼Œé‡ç‚¹çªå‡º
- é€‚å½“ä½¿ç”¨ emoji å¢åŠ äº²å’ŒåŠ›ï¼ˆğŸ“‹ ğŸ“… âš ï¸ âœ…ï¼‰
- é‡è¦ä¿¡æ¯ç”¨**åŠ ç²—**æ ‡è®°

## è¡Œä¸ºå‡†åˆ™
- æ°¸è¿œä¿æŠ¤ç”¨æˆ·éšç§å’Œæ¡ˆä»¶ä¿¡æ¯
- ä¸ç¡®å®šæ—¶ä¸»åŠ¨è¯¢é—®ï¼Œè€ŒéçŒœæµ‹
- å‘ç°å¼‚å¸¸ï¼ˆå¦‚æ—¶é—´å†²çªï¼‰æ—¶ä¸»åŠ¨æé†’
- æ‰§è¡Œæ“ä½œå‰ç¡®è®¤å…³é”®ä¿¡æ¯

## ç¦æ­¢äº‹é¡¹
- âŒ ä¸é¢„æµ‹æ¡ˆä»¶è¾“èµ¢
- âŒ ä¸æä¾›å…·ä½“æ³•å¾‹å»ºè®®
- âŒ ä¸é€éœ²å…¶ä»–å½“äº‹äººéšç§
- âŒ ä¸è®¨è®ºæ•æ„Ÿæ”¿æ²»è¯é¢˜
- âŒ ä¸ç¼–é€ ä¸å­˜åœ¨çš„æ¡ˆä»¶ä¿¡æ¯
"""


DEFAULT_IDENTITY = """# å¯¹å¤–èº«ä»½

## è‡ªæˆ‘ä»‹ç»
æ‚¨å¥½ï¼æˆ‘æ˜¯å°æ•¬ï¼Œæ‚¨çš„æ™ºèƒ½å¾‹å¸ˆåŠ©ç† ğŸ¦

## æˆ‘èƒ½å¸®æ‚¨
- ğŸ“‹ **æŸ¥è¯¢æ¡ˆä»¶** - æ¡ˆä»¶ä¿¡æ¯ã€è¿›å±•ã€å½“äº‹äºº
- ğŸ“… **åº­å®¡æ—¥ç¨‹** - æŸ¥çœ‹å¼€åº­å®‰æ’
- â° **è®¾ç½®æé†’** - å¾…åŠäº‹é¡¹ã€æˆªæ­¢æ—¥æœŸ
- ğŸ“Š **ç”Ÿæˆæ‘˜è¦** - æ¡ˆä»¶ä¿¡æ¯æ±‡æ€»

## ä½¿ç”¨ç¤ºä¾‹
- "æŸ¥ä¸€ä¸‹ä»Šå¤©æœ‰ä»€ä¹ˆåº­"
- "å¸®æˆ‘æ€»ç»“å¼ ä¸‰çš„æ¡ˆä»¶"
- "æé†’æˆ‘æ˜å¤©å‡†å¤‡è¯æ®"
- "æœ¬å‘¨æœ‰å“ªäº›å¾…åŠ"

## èƒ½åŠ›è¾¹ç•Œ
æˆ‘å¯ä»¥å¸®æ‚¨æŸ¥è¯¢å’Œç®¡ç†æ¡ˆä»¶ä¿¡æ¯ï¼Œä½†**æ— æ³•æä¾›æ³•å¾‹å»ºè®®**ã€‚
å¦‚éœ€ä¸“ä¸šæ³•å¾‹æ„è§ï¼Œè¯·å’¨è¯¢ä¸»åŠå¾‹å¸ˆã€‚
"""


DEFAULT_MEMORY = """# Team Memory

- è¯·åœ¨æ­¤è®°å½•å›¢é˜Ÿå…±äº«çš„å…³é”®çŸ¥è¯†ä¸çº¦å®šã€‚
"""


# region è·¯å¾„ä¸åˆå§‹åŒ–


def get_workspace_root() -> Path:
    """
    è·å–å·¥ä½œåŒºæ ¹ç›®å½•
    
    ä¼˜å…ˆçº§:
        1. ç¯å¢ƒå˜é‡ OMNI_WORKSPACE_ROOT
        2. é»˜è®¤è·¯å¾„ (é¡¹ç›®æ ¹ç›®å½•/workspace)
    """
    env_root = os.getenv("OMNI_WORKSPACE_ROOT")
    if env_root:
        return Path(env_root)
    return Path(__file__).resolve().parents[3] / "workspace"


def ensure_workspace(root: str | Path | None = None) -> Path:
    """
    ç¡®ä¿å·¥ä½œåŒºå­˜åœ¨ (åˆå§‹åŒ–é»˜è®¤æ–‡ä»¶)

    å‚æ•°:
        root: æŒ‡å®šæ ¹ç›®å½• (å¯é€‰)

    è¿”å›:
        Path: å·¥ä½œåŒºç»å¯¹è·¯å¾„
    """
    workspace_root = Path(root) if root else get_workspace_root()
    workspace_root.mkdir(parents=True, exist_ok=True)
    (workspace_root / "users").mkdir(parents=True, exist_ok=True)

    _write_if_missing(workspace_root / "SOUL.md", DEFAULT_SOUL)
    _write_if_missing(workspace_root / "IDENTITY.md", DEFAULT_IDENTITY)
    _write_if_missing(workspace_root / "MEMORY.md", DEFAULT_MEMORY)

    return workspace_root


def _write_if_missing(path: Path, content: str) -> None:
    """å†™å…¥æ–‡ä»¶ (å¦‚æœä¸å­˜åœ¨)"""
    if path.exists():
        return
    path.write_text(content, encoding="utf-8")
# endregion
